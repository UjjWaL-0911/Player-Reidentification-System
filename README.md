# ⚽Football Player Re-Identification System⚽

This project is a football player re-identification system that leverages deep learning for detecting, tracking, and re-identifying players in football match videos. The system uses a custom YOLO model for detection and the Torchreid library for re-identification, providing both frame-by-frame analysis and a visual output video.

## Features
- Detects players, referees, goalkeepers, and the ball in football match videos
- Re-identifies players across frames
- Visualizes detections and re-identification results
- Outputs annotated video and sample screenshots

## Project Structure
- `StealthMode.ipynb`: Main notebook for running the detection and re-identification pipeline
- `deep-person-reid/`: Torchreid library for person re-identification
- `outputs/`: Contains detection results, annotated frames, screenshots, and output videos
- `frames/`: Extracted frames from input videos
- `best.pt`: Custom YOLO model weights

## Setup
1. **Install dependencies**
   - Python 3.11
   - PyTorch, Torchvision, Torchaudio
   - Ultralytics (for YOLO)
   - OpenCV, NumPy, SciPy, scikit-learn
   - See `deep-person-reid/requirements.txt` for more

2. **Download or provide the YOLO model weights**
   - Place `best.pt` in the project root

## Usage
1. **Extract frames from a video**
   - The notebook extracts frames from the input video at a specified interval.

2. **Run detection**
   - YOLO detects players, referees, goalkeepers, and the ball in each frame.
   - Results are saved as JSON in `outputs/`.

3. **Re-identification**
   - Torchreid is used to extract features and match player identities across frames.

4. **Visualization**
   - Annotated frames are saved in `outputs/vis_15sec_input_720p/`.
   - A final output video is generated with bounding boxes and player IDs.

## Example Results
Below are sample screenshots and the output video generated by the system:

### Sample Screenshots
Look at the player with id:12
![Screenshot 1](outputs/Screenshot%20(136).png)


The player leaves the frame 
![Screenshot 2](outputs/Screenshot%20(137).png)


The player re-enters the frame and gets assigned the same id:12
![Screenshot 3](outputs/Screenshot%20(138).png)

### Output Video

Check out the whole output video here :[output_reid_re_entry.mp4](outputs/output_reid_re_entry.mp4)

> _Click the link above to view the annotated output video._

## References
- [Torchreid (deep-person-reid)](https://github.com/KaiyangZhou/deep-person-reid)
- [Ultralytics YOLO](https://github.com/ultralytics/ultralytics)


## Known Limitations and Challenges

While this football player re-identification system demonstrates strong performance in many scenarios, it is important to acknowledge several limitations and challenges:

- **Accuracy is not guaranteed**: The system may not always correctly re-identify players, especially in crowded scenes, occlusions, or when players have similar appearances.
- **Short-term vs. long-term re-identification**: The system is able to re-identify players who leave the frame for a short duration and then re-enter. However, it struggles to maintain identity consistency for players who are absent from the frame for longer periods, often resulting in new IDs being assigned upon their return.
- **Resource requirements**: Processing high-resolution videos or long sequences can be computationally intensive and may require significant GPU resources.

---

## Exploration of SoccerNet Game State Reconstruction ([SoccerNet/sn-gamestate](https://github.com/SoccerNet/sn-gamestate))

In an effort to further improve the accuracy and robustness of this pipeline, I explored integrating the [SoccerNet Game State Reconstruction](https://github.com/SoccerNet/sn-gamestate) framework. This open-source project provides state-of-the-art tools for end-to-end athlete tracking and identification, including advanced modules for detection, re-identification, and game state analysis [source](https://github.com/SoccerNet/sn-gamestate).

The integration of this pipeline could potentially:
- Enhance tracking and re-identification performance, especially in challenging scenarios.
- Provide more consistent player IDs across longer video sequences.
- Leverage additional features such as jersey number recognition and field localization.

**However, due to resource constraints (hardware, time, and storage), I was unable to fully integrate and benchmark this advanced pipeline within my current project.**

If provided with sufficient computational resources and time, I believe that combining my current approach with the SoccerNet/sn-gamestate framework would yield even better results and more robust player re-identification in football videos.

